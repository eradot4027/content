documentation_complete: true

prodtype: sle15

title: 'Ensure AppArmor Profiles are in enforce or complain'

description: |-
    AppArmor profiles define what resources applications are able to access.

rationale: |-
    Security configuration requirements vary from site to site. Some sites may mandate a policy 
    that is stricter than the default policy, which is perfectly acceptable. This item is intended 
    to ensure that any policies that exist on the system are activated..

severity: high

references:
    cis@sle15: 1.7.1.3

ocil_clause: 'profiles are in enforce pr complain'

ocil: |-
    Run the following command and verify that profiles are loaded, profiles are in enforce or 
    complain mode, and no processes are unconfined:
    <pre>apparmor_status | grep profiles</pre>
    <br /><br />
    Output will be similar to:
    <pre>37 profiles are loaded.
         35 profiles are in enforce mode.
         2 profiles are in complain mode.
         4 processes have profiles defined.</pre>
    <br /><br />

platform: machine